<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link href="https://fonts.googleapis.com/css?family=Pacifico|Signika|Ubuntu" rel="stylesheet">
	<title>GeeMail</title>
	<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
    <script>
      window.onload = function(){
        // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
				// We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser

//basic helper function
			function generateElem(elemType, cName, text) {
  			var newElem = document.createElement(elemType);
  			newElem.className = cName;
  			newElem.innerHTML = text;
  
  			return newElem;
			}

//email counter function
			var counter = window.geemails.length;
		
			function returnCount(x){
				for (var i=0; i<x.length; i++);
				return x;
			}
			var emailCount = (returnCount("You have " + counter + " geeMails!"));
			
//heading content
			var counterBox = document.createElement('h2');
			counterBox.className = 'counter';
			document.body.appendChild(counterBox);
			
			var headingBox = document.createElement('section');
			headingBox.className = 'headings';
			document.body.appendChild(headingBox);

			var senderElem = generateElem('div', 'senderHeading', "Sender");
			headingBox.appendChild(senderElem);
			
			var subjectElem = generateElem('div', 'subjectHeading', "Subject");
			headingBox.appendChild(subjectElem);

			var dateElem = generateElem('div', 'dateHeading', 'Date');
			headingBox.appendChild(dateElem);
			
//function to load mail content into the body
			function loadMail(content) {
				for (var i=0; i<content.length; i++){

					//container for mail headings   
					var mailBox = document.createElement('section');
					mailBox.className = 'messages';
					document.body.appendChild(mailBox);
					
					var senderData = generateElem('div', 'sender', content[i].sender);
					mailBox.appendChild(senderData);

					var subjectData = generateElem('div', 'subject', content[i].subject);
					mailBox.appendChild(subjectData);

					var dateData = generateElem('div', 'date', content[i].date);
					mailBox.appendChild(dateData);

					var bodyData = generateElem('div', 'body', content[i].body);
					mailBox.appendChild(bodyData);

					mailBox.addEventListener('click', showMail);

				}
				
			}
		loadMail(window.geemails);

//creates and appends a new message to the application
var newMessages = setInterval(newMail, 5000);

function newMail(){

		var newMail = getNewMessage();

		var mailBoxTwo = document.createElement('section');
		mailBoxTwo.className = 'messages';
		document.body.appendChild(mailBoxTwo);
		
		var newSender = generateElem('div', 'sender', newMail.sender);
		mailBoxTwo.appendChild(newSender);

		var newSubject = generateElem('div', 'subject', newMail.subject);
		mailBoxTwo.appendChild(newSubject);

		var newDate = generateElem('div', 'date', newMail.date);
		mailBoxTwo.appendChild(newDate);

		var newBody = generateElem('div', 'body', newMail.body);
		mailBoxTwo.appendChild(newBody);

		mailBoxTwo.addEventListener('click', showMail);

//increment the email counter as additional emails pass through
		var addMail = counter++;  
		counterBox.innerHTML = ("You have " + addMail + " geeMails!");
		
}
newMail(getNewMessage());

//adds event listner to show message content on click
		function showMail() {
			var childElem = this.querySelectorAll('.body')[0];
			if (childElem.style.display === 'block') {
				childElem.style.display = 'none';
			} else { 
				childElem.style.display = 'block';
			}
		}


};


			

    </script>
</head>
<body>
	<section id="top-box">
		<div id="heading">
			<h1 class="geeMail">Gee-Mail <img src="images/devLogo.jpeg" alt="devLogo" class="logo"></h1>
		</div>
	</section>

</body>
</html>